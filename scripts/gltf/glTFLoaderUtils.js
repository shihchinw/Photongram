THREE.GLTFLoaderUtils=Object.create(Object,{MISSING_DESCRIPTION:{value:"MISSING_DESCRIPTION"},INVALID_PATH:{value:"INVALID_PATH"},INVALID_TYPE:{value:"INVALID_TYPE"},XMLHTTPREQUEST_STATUS_ERROR:{value:"XMLHTTPREQUEST_STATUS_ERROR"},NOT_FOUND:{value:"NOT_FOUND"},ARRAY_BUFFER:{value:"ArrayBuffer"},_streams:{value:{},writable:!0},_streamsStatus:{value:{},writable:!0},_resources:{value:{},writable:!0},_resourcesStatus:{value:{},writable:!0},init:{value:function(){this._streams={},this._streamsStatus={},this._resources={},this._resourcesStatus={}}},_containsResource:{enumerable:!1,value:function(e){return!!this._resources[e]}},_storeResource:{enumerable:!1,value:function(e,r){return e?(this._containsResource[e]&&console.log("WARNING: resource:"+e+" is already stored, overriding"),void(this._resources[e]=r)):void console.log("ERROR: entry does not contain id, cannot store")}},_getResource:{enumerable:!1,value:function(e){return this._resources[e]}},_loadStream:{value:function(e,r,t){function a(e,r){var t=decodeURIComponent(r);return e?atob(t):t}function s(e,r){for(var t=a(e,r),s=new ArrayBuffer(t.length),n=new Uint8Array(s),u=0;u<t.length;u++)n[u]=t.charCodeAt(u);return s}function n(e,r){r="undefined"!=typeof r?r:"";var t=e[1],n=!!e[2],u=e[3];switch(r){case"":case"text":return a(n,u);case"ArrayBuffer":return s(n,u);case"blob":var i=s(n,u);return new Blob([i],{type:t});case"document":var o=new DOMParser;return o.parseFromString(a(n,u),t);case"json":return JSON.parse(a(n,u));default:throw"Unhandled responseType: "+r}}var u=/^data:(.*?)(;base64)?,(.*)$/,i=u.exec(e);if(null!==i)return void t.streamAvailable(e,n(i,r));if(!r)return void t.handleError(THREE.GLTFLoaderUtils.INVALID_TYPE,null);if(!e)return void t.handleError(THREE.GLTFLoaderUtils.INVALID_PATH);var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType=r===this.ARRAY_BUFFER?"arraybuffer":"text",o.setRequestHeader("If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),o.onload=function(r){200==o.status||206==o.status?t.streamAvailable(e,o.response):t.handleError(THREE.GLTFLoaderUtils.XMLHTTPREQUEST_STATUS_ERROR,this.status)},o.send(null)}},send:{value:0,writable:!0},requested:{value:0,writable:!0},_handleRequest:{value:function(e){var r=this._resourcesStatus[e.id];r?this._resourcesStatus[e.id]++:this._resourcesStatus[e.id]=1;var t=this._streamsStatus[e.uri];if(t&&"loading"===t.status)return void t.requests.push(e);this._streamsStatus[e.uri]={status:"loading",requests:[e]};var a=this,s={};s.streamAvailable=function(e,r){var t=a._streamsStatus[e],s=t.requests;s.forEach(function(e){var t=r.slice(e.range[0],e.range[1]),s=e.delegate.convert(t,e.ctx);a._storeResource(e.id,s),e.delegate.resourceAvailable(s,e.ctx),--a._resourcesStatus[e.id]},this),delete a._streamsStatus[e]},s.handleError=function(r,t){e.delegate.handleError(r,t)},this._loadStream(e.uri,e.type,s)}},_elementSizeForGLType:{value:function(e,r){var t=0;switch(r){case"SCALAR":t=1;break;case"VEC2":t=2;break;case"VEC3":t=3;break;case"VEC4":t=4;break;case"MAT2":t=4;break;case"MAT3":t=9;break;case"MAT4":t=16}switch(e){case WebGLRenderingContext.FLOAT:return Float32Array.BYTES_PER_ELEMENT*t;case WebGLRenderingContext.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT*t;case WebGLRenderingContext.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT*t;default:return null}}},_handleWrappedBufferViewResourceLoading:{value:function(e,r,t){var a=e.bufferView,s=a.buffer,n=e.byteOffset+a.description.byteOffset,u=[n,this._elementSizeForGLType(e.componentType,e.type)*e.count+n];this._handleRequest({id:e.id,range:u,type:s.description.type,uri:s.description.uri,delegate:r,ctx:t},null)}},getBuffer:{value:function(e,r,t){this._getResource(e.id);return this._handleWrappedBufferViewResourceLoading(e,r,t),null}},getFile:{value:function(e,r,t){return e.delegate=r,e.ctx=t,this._handleRequest({id:e.id,uri:e.uri,range:[0],type:"text",delegate:r,ctx:t},null),null}}});